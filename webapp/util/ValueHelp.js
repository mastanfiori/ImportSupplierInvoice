/*
 * Copyright (C) 2009-2019 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","fin/ap/invoice/upload/util/Constants"],function(O,C){"use strict";return O.extend("fin.ap.invoice.upload.util.ValueHelp",{_oController:undefined,_oEditComboBox:undefined,_sEntitySetName:undefined,_sEntityTypeName:undefined,_sEntityPath:undefined,_sVHFieldName:undefined,_aColFieldName:[],_sTitle:undefined,_aColumnList:[],constructor:function(c,e,E,s,a,v,b){sap.ui.base.Object.apply(this);this._oController=c;this._oEditDialog=e;this._oEditComboBox=E;this._sEntitySetName=s;this._sEntityTypeName=a;this._sVHFieldName=v;this._aColFieldName=b;this._sEntityPath="/"+s;},openValueHelp:function(e){var t=this;var T="/#"+this._sEntityTypeName+"/"+this._sVHFieldName+"/@sap:label";var s=this._oController.getOwnerComponent().getModel().getProperty(T);var f=t._oEditComboBox.getName();var v=new sap.ui.comp.valuehelpdialog.ValueHelpDialog({title:s,modal:true,supportMultiselect:false,supportRanges:false,supportRangesOnly:false,ok:function(d){var g=d.getParameter("tokens");if(g&&g.length>0){var r=g[0].getCustomData()[0].getValue();t._oEditComboBox.setSelectedKey(C.ComboBoxUserInput);t._oEditComboBox.setValue(r[t._sVHFieldName]);t._oEditDialog.storeFieldOldKeyValue(f,C.ComboBoxUserInput,r[t._sVHFieldName]);}this.close();},cancel:function(){t._oEditDialog.setBackFieldOldKeyValue(f);this.close();},afterClose:function(){this.destroy();}});var c=new sap.ui.model.json.JSONModel();var a=[];var o,l;for(var i=0;i<t._aColFieldName.length;i++){l="/#"+t._sEntityTypeName+"/"+t._aColFieldName[i]+"/@sap:label";o={label:t._oController.getOwnerComponent().getModel().getProperty(l),template:t._aColFieldName[i]};a.push(o);}c.setData({cols:a});v.setModel(c,"columns");v.setModel(this._oController.getOwnerComponent().getModel());v.getTable().bindRows(this._sEntityPath);var S=function(d){var g=d.getSource().getFilters();var p=d.getSource().getParameters();v.getTable().bindRows({path:t._sEntityPath,filters:g,parameters:p});};var b=new sap.ui.comp.smartfilterbar.SmartFilterBar({advancedMode:true,expandAdvancedArea:true,entitySet:t._sEntitySetName,basicSearchFieldName:t._sVHFieldName,enableBasicSearch:true,search:function(d){S(d);}});v.setFilterBar(b);v.addStyleClass("sapUiSizeCompact");v.setContentWidth("85%");v.setVerticalScrolling(false);v.open();}});});
